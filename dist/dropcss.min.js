/*! https://github.com/leeoniya/dropcss (v0.5.0) */
!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?module.exports=r():"function"==typeof define&&define.amd?define(r):(e=e||self).dropcss=r()}(this,function(){"use strict";var e=1,r=2,n=3,t=4,a=new Set("area base br col command embed hr img input keygen link meta param source track wbr".split(" ")),s=/<!doctype[^>]*>|<!--[\s\S]*?-->|<script[^>]*>[\s\S]*?<\/script>|<style[^>]*>[\s\S]*?<\/style>|<link[^>]*>|<meta[^>]*>/gim,i=/([\w-]+)(?:="([^"]*)"|='([^']*)'|=(\S+))?/gm,c={TAG_HEAD:/\s*<([a-z0-9_-]+)(?:\s+([^>]*))?>\s*/my,TAG_TEXT:/\s*[^<]*/my,TAG_CLOSE:/\s*<\/[a-z0-9_-]+>\s*/my};var o=new Set;function l(e,r,n){var t="#"==r;return{tagName:r,attributes:n,classList:!t&&null!=n&&n.has("class")?new Set(n.get("class").split(/\s+/g)):o,parentNode:e,childNodes:t?null:[]}}var u=function(u,d){var f=function(s,o){var l,u=0,d=[];function f(e){for(var r in u=e.lastIndex,c)c[r].lastIndex=u}function h(){if(null!=(l=c.TAG_CLOSE.exec(s)))return f(c.TAG_CLOSE),void d.push(t);if(null==(l=c.TAG_HEAD.exec(s)))null!=(l=c.TAG_TEXT.exec(s))&&(f(c.TAG_TEXT),o&&d.push(n,l[0]));else{f(c.TAG_HEAD);var u=l[1];d.push(e,u);var h=l[2];if(null!=h){for(var p,m=new Map;p=i.exec(h);)m.set(p[1],(p[2]||p[3]||p[4]||"").trim());d.push(r,m)}a.has(u)&&d.push(t)}}for(;u<s.length;)h();return f({lastIndex:0}),d}(u=u.replace(s,""),!d),h={nodes:[],tag:new Set(["*"]),class:new Set,attr:new Set};!function(a,s){for(var i,c=l(null,"root",o),u=0;u<a.length;u++)switch(a[u]){case e:var d=a[++u],f=o;a[u+1]===r&&(f=a[u+=2]),i=c.childNodes.length,c.childNodes.push(c=l(c,d,f)),s(c,i);break;case t:c=c.parentNode;break;case n:var h=l(c,"#",o);c.childNodes.push(h),s(h,c.childNodes.length-1)}}(f,function(e,r){return function(e,r,n){e.idx=r;var t=e.attributes;n.tag.add(e.tagName),e.classList.forEach(function(e){return n.class.add(e)}),t.has("id")&&n.attr.add("[id="+t.get("id")+"]"),t.has("type")&&n.attr.add("[type="+t.get("type")+"]"),n.nodes.push(e)}(e,r,h)});return h},d=/\s*\/\*[\s\S]*?\*\/\s*/gm,f=/\s*[>~+]\s*|\s+/g,h=1,p=2,m=3,v=4,x=5;function g(e,r){for(var n="",t=1;"{"==e[r]?t++:"}"==e[r]&&t--,0!=t;)n+=e[r++];return n}function b(e){var r,n={RULE_HEAD:/\s*([^{;]+?)\s*[{;]\s*/my,RULE_TAIL:/\s*([^}]*?)\s*\}/my,AT_TAIL:/\s*\}/my,RULE_FULL:/\s*([^{]*?)\{([^}]+?)\}/my},t=0,a=0,s=[];function i(e){for(var r in a=e.lastIndex,n)n[r].lastIndex=a}function c(){if(t>0&&null!=(r=n.AT_TAIL.exec(e)))return t--,s.push(p),void i(n.AT_TAIL);if(null!=(r=n.RULE_HEAD.exec(e))){var c=r[1];if(i(n.RULE_HEAD),"@"==c[0])switch(c.match(/@[a-z-]+/)[0]){case"@media":case"@supports":case"@document":t++,s.push(h,c);break;case"@import":case"@charset":case"@namespace":s.push(x,c+";");break;default:t++;var o=g(e,a);i({lastIndex:a+o.length}),s.push(h,c,x,o)}else s.push(m,(l=r[1],(u=l.split(/\s*,\s*/gm)).push(u.map(function(e){return function(e){return e.replace(/:?:[a-z-]+(?:\([^()]+\))?/gm,"")}(e).trim().replace(/(\.|#|\[)/gm," $1").replace(/\]/gm,"] ").trim().split(f)})),u)),r=n.RULE_TAIL.exec(e),s.push(v,r[1]),i(n.RULE_TAIL)}else a=e.length;var l,u}for(;a<e.length;)c();return s}function T(e,r){return r==e.tagName||"*"==r}function k(e,r,n,t){t=t||"=";var a=e.attributes;if(a.has(r)){var s=a.get(r);switch(t){case"=":return null==n||n==s;case"*=":return-1!=s.indexOf(n);case"^=":return s.startsWith(n);case"$=":return s.endsWith(n)}}return!1}function y(e,r){return e.classList.has(r)}function E(e,r){return e.some(function(e){return function e(r,n){var t,a,s,i,c,o;for(;n.idx>-1;){switch(r[n.idx]){case"_":t=r[--n.idx],o=T(n.node,t),n.idx--;break;case"#":a=r[--n.idx],o=k(n.node,"id",a,"="),n.idx--;break;case".":t=r[--n.idx],o=y(n.node,t),n.idx--;break;case"[":t=r[--n.idx],s=r[--n.idx],a=r[--n.idx],o=k(n.node,t,a,s),n.idx--;break;case":":t=r[--n.idx],a=r[--n.idx];var l=n.node;c=l.idx;var u=(i=l.parentNode)?i.childNodes.length:1;switch(t){case"not":o=!e(a,{node:n.node,idx:a.length-1});break;case"empty":o="#"!=l.tagName&&0==l.childNodes.length;break;case"first-child":o=0==c;break;case"last-child":o=c==u-1;break;case"only-child":o=1==u;break;case"nth-child":o=w(c+1,a);break;case"nth-last-child":o=w(u-c,a)}n.idx--;break;case" ":for(c=--n.idx,o=!1;!o&&null!=(i=n.node.parentNode);)n.idx=c,n.node=i,o=e(r,n);break;case">":n.idx--,null!=(i=n.node.parentNode)?(n.node=i,o=e(r,n)):o=!1;break;case"+":n.idx--,null!=(i=n.node.parentNode)&&n.node.idx>0?(n.node=i.childNodes[n.node.idx-1],o=e(r,n)):o=!1;break;case"~":if(n.idx--,o=!1,c=n.node.idx,null!=(i=n.node.parentNode)&&c>0)for(var d=0;d<c&&!o;d++)n.node=i.childNodes[d],o=e(r,n)}if(!o)break}return o}(r,{idx:r.length-1,node:e})})}var A=/^([+-]?\d*)?n([+-]\d+)?$/;function w(e,r){if("odd"==r)res=e%2==1;else if("even"==r)res=e%2==0;else if(/^\d+$/.test(r))res=e==+r;else{var n=function(e){var r=A.exec(e);if(null!=r){var n=r[1],t=r[2];return[n=null==n||"+"==n?1:"-"==n?-1:+n,t=null==t?0:+t]}return[0,0]}(r);res=function(e,r,n){if(r<0&&e<=0)return!1;if(-1===e)return n<=r;if(0===e)return n===r;if(1===e)return r<0||n>=r;var t=r%e;return t<0&&(t+=e),e>1?n>=r&&n%e===t:(e*=-1,n<=r&&n%e===t)}(n[0],n[1],e)}return res}var N=function(e,r){return E(e,Array.isArray(r)?r:function e(r){var n,t={IDENT:/([\w*-]+)/iy,ATTR:/([\w-]+)(?:(.?=)"?([^\]]*?)"?)?\]/iy,PSEUDO:/([\w-]+)(?:\(([^)]*)\))?/iy,MODE:/\s*[:.#\[]\s*/iy,COMB:/\s*[>~+]\s*|\s+/iy},a=0,s=[],i=-1;function c(e){for(var r in a=e.lastIndex,t)t[r].lastIndex=a}function o(){var o=!1;if(n=t.COMB.exec(r)){o=!0;var l=n[0].trim();""==l&&(l=" "),s.push(l),c(t.COMB),i=a}else if(n=t.MODE.exec(r)){o=!0;var u=n[0].trim();c(t.MODE),":"==u?(n=t.PSEUDO.exec(r),s.splice(i+1,0,null!=n[2]&&"not"==n[1]?e(n[2]):n[2],n[1],u),c(t.PSEUDO)):"["==u?(n=t.ATTR.exec(r),s.splice(i+1,0,n[3],n[2],n[1],u),c(t.ATTR)):(n=t.IDENT.exec(r),s.push(n[1],u),c(t.IDENT))}else(n=t.IDENT.exec(r))&&(o=!0,s.push(n[1],"_"),c(t.IDENT));return o}for(;a<r.length;)o();return s}(r))},_=/\[([\w-]+)(?:(.?=)"?([^\]]*?)"?)?\]/i,L=/:(?:first|last|nth|only|not|empty)\b/;function I(e,r,n){for(var t=r.length-1;t>-1;t--){var a=r[t];n.has(a[2])||(s=e,i=a[0],c=a[1],o="",e=s.slice(0,i)+o+s.slice(i+c))}var s,i,c,o;return e}var S=function(e){return!0};return function(e){for(var r=u(e.html,!e.keepText),n=e.shouldDrop||S,t=b(e.css.replace(d,"")),a={},s=0;s<t.length;s++)if(t[s]===m){var i=t[s+1],c=i[i.length-1];s++;for(var o=0;o<c.length;o++){var l=c[o];e:for(var f=0;f<l.length;f++){var T=l[f],y=!1,E=void 0;if(""!=T){if(T in a)y=a[T];else switch(T[0]){case"#":E=T.substr(1),a[T]=y=r.attr.has("[id="+E+"]");break;case".":E=T.substr(1),a[T]=y=r.class.has(E);break;case"[":if(T.startsWith("[type="))a[T]=y=r.attr.has(T);else{var A=T.match(_);a[T]=y=r.nodes.some(function(e){return k(e,A[1],A[3],A[2])})}break;default:a[T]=y=r.tag.has(T)}if(!y){!0===n(i[o])?i[o]=null:a[i[o]]=!0;break e}}}}}for(var w=0;w<t.length;w++)t[w]===m&&(t[++w].length,t[w]=t[w].filter(function(e){if("string"==typeof e){if(e in a)return a[e];var t=(s=e).replace(/:?:[a-z-]+/gm,function(e){return s.startsWith("::")||!L.test(e)?"":e}).replace(/:[a-z-]+\(\)/gm,"");return""==t||(t in a?a[t]:a[t]=N(r.nodes,t)||!0!==n(e))}var s;return!1}));var D=function(e){for(var r="",n=0,t=0;t<e.length;t++)switch(e[t]){case m:var a=e[++t];(n=a.length)>0&&(r+=a.join());break;case v:n>0&&(r+="{"+e[++t]+"}");break;case h:r+=e[++t]+"{";break;case p:r+="}";break;case x:r+=e[++t]}return r.replace(/@[a-z-]+\s+[^{]+\{\s*\}/gm,"")}(t);return{css:D=function(e){for(var r,n=[],t=new Set,a=/@font-face[\s\S]+?font-family:\s*(['"\w-]+)[^}]+\}/gm;r=a.exec(e);){var s=r[1].replace(/['"]/gm,"");n.push([r.index,r[0].length,s])}for(var i=/font-family:([^;!}]+)/gm;r=i.exec(e);)n.some(function(e){return r.index>e[0]&&r.index<e[0]+e[1]})||r[1].trim().split(",").forEach(function(e){t.add(e.trim().replace(/['"]/gm,""))});return I(e,n,t)}(D=function(e){for(var r,n=[],t=new Set,a=/@(?:-\w+-)?keyframes\s+([\w-]+)\s*\{/gm;r=a.exec(e);){var s=g(e,a.lastIndex);n.push([r.index,r[0].length+s.length+1,r[1]])}for(var i=/animation(?:-name)?:([^;!}]+)/gm;r=i.exec(e);)r[1].trim().split(",").forEach(function(e){t.add(e.trim().match(/^[\w-]+/)[0])});return I(e,n,t)}(D))}}});
